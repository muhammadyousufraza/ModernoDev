"use strict";function bs_cache_handle_automatic_purge_option_selection(){const e=document.querySelector("input[name='bs_cache_cf_auto_purge']"),s=document.querySelector("input[name='bs_cache_cf_auto_purge_all']");e&&s&&(e.addEventListener("change",(()=>{e.checked&&(s.checked=!1)})),s.addEventListener("change",(()=>{s.checked&&(e.checked=!1)})))}function bs_cache_handle_conditional_settings(e){parseInt(e.value)>0?(document.querySelectorAll(`.${e.dataset.mainoption}`).length>0&&document.querySelectorAll(`.${e.dataset.mainoption}`).forEach((e=>{e.classList.contains("bs_cache_hide")&&e.classList.remove("bs_cache_hide")})),document.querySelectorAll(`.${e.dataset.mainoption}_not`).length>0&&document.querySelectorAll(`.${e.dataset.mainoption}_not`).forEach((e=>{e.classList.add("bs_cache_hide")}))):(document.querySelectorAll(`.${e.dataset.mainoption}`).length>0&&document.querySelectorAll(`.${e.dataset.mainoption}`).forEach((e=>{e.classList.add("bs_cache_hide")})),document.querySelectorAll(`.${e.dataset.mainoption}_not`).length>0&&document.querySelectorAll(`.${e.dataset.mainoption}_not`).forEach((e=>{e.classList.contains("bs_cache_hide")&&e.classList.remove("bs_cache_hide")})))}function bs_cache_lock_screen(){if(!document.querySelector(".bs_cache_please_wait")){const e=document.createElement("div");e.classList.add("bs_cache_please_wait"),e.innerHTML=`<div class="bs-cache-loader-wrapper"><img src="${window.location.origin}/wp-content/plugins/bigscoots-cache/assets/img/bigscoots-loader-animation.gif" alt="BigScoots Loading Animation" class="bs-cache-loader" width="120" height="120" decoding="async" loading="eager" fetchpriority="high"><p class="bs-cache-loader-text">Please wait! Your request is being processed...</p></div>`,document.body.prepend(e)}}function bs_cache_unlock_screen(){document.querySelector(".bs_cache_please_wait").remove()}function bs_cache_redirect_to_page(e){window.location=e}function bs_cache_refresh_page(){window.location.reload()}function bs_cache_display_ok_dialog(e,s,a,t,c,o,n,r,l){a=void 0===a||null==a?350:parseInt(a),t=void 0===t||null==t?300:parseInt(t),o=void 0===o?null:o,n=void 0===n?"Close":n,r=void 0===r?null:r,l=void 0===l?null:l;let i="";switch(c=void 0===c?null:c){case"warning":case"error":case"info":case"question":i=c;break;default:i="success"}null==r?Swal.fire({title:null!==o?o:"",html:s,icon:i,confirmButtonText:n}):Swal.fire({title:null!==o?o:"",html:s,icon:i,confirmButtonText:n,willClose:()=>{null!=l?r(l):r()}}).then((e=>{e.isConfirmed&&(null!=l?r(l):r())}))}function bs_cache_is_valid_url(e){let s;try{s=new URL(e)}catch(e){return!1}return"http:"===s.protocol||"https:"===s.protocol}function bs_cache_toggle_settings_visibility(){const e=document.getElementById("toggle-bs-cache-settings");"false"===e.dataset.show_settings?Swal.fire({title:"Are you sure about it?",text:"Changing these settings without fully understanding them could cause problems on your website. If you have a specific requirement, it's advisable to reach out to support. Are you sure you want to continue?",icon:"warning",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Yes, Absolutely",denyButtonText:"No, Open a Support Ticket instead"}).then((s=>{s.isConfirmed?bs_cache_save_toggle_settings_visibility(e.dataset.user_id,"true"):s.isDenied&&window.open("https://wpo.bigscoots.com/user/tickets/open","_blank")})):bs_cache_save_toggle_settings_visibility(e.dataset.user_id,"false")}async function bs_cache_save_toggle_settings_visibility(e,s){try{bs_cache_lock_screen();const a=await fetch(`${bs_cache_data.api_base}/settings-visibility`,{method:"PATCH",headers:{"Content-Type":"application/json; charset=UTF-8","X-WP-Nonce":bs_cache_data.api_nonce},body:JSON.stringify({user_id:parseInt(e),show_settings:s,toggle_settings_page:"bigscoots-cache-settings"}),credentials:"same-origin",timeout:1e4});if(a.ok){const e=await a.json();bs_cache_unlock_screen(),e.code?bs_cache_display_ok_dialog("Error",`${e.message}`,null,null,"error"):e.success?bs_cache_display_ok_dialog("Success",`${e.message}`,null,null,"success",null,"Close",(()=>{bs_cache_refresh_page()})):bs_cache_display_ok_dialog("Error","Something went wrong! Please contact support for further investigation.",null,null,"error")}else{const e=await a.json();console.error(`${e.code}: ${e.message} (Status code: ${e.data.status})`),bs_cache_unlock_screen(),bs_cache_display_ok_dialog("Error",`Unable to toggle settings visibility. ${e.message} Please refresh the page and try again. If the issue remains, please contact our support team.`,null,null,"error")}}catch(e){alert(`Error: ${e.status} ${e.message}`),console.error(e),bs_cache_unlock_screen()}}function bs_cache_toggle_perfmatters_settings_visibility(){const e=document.getElementById("toggle-perfmatters-settings");"false"===e.dataset.show_settings?Swal.fire({title:"Are you sure about it?",text:"Changing these settings without fully understanding them could cause problems on your website. If you have a specific requirement, it's advisable to reach out to support. Are you sure you want to continue?",icon:"warning",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Yes, Absolutely",denyButtonText:"No, Open a Support Ticket instead"}).then((s=>{s.isConfirmed?bs_cache_save_toggle_perfmatters_settings_visibility(e.dataset.user_id,"true"):s.isDenied&&window.open("https://wpo.bigscoots.com/user/tickets/open","_blank")})):bs_cache_save_toggle_perfmatters_settings_visibility(e.dataset.user_id,"false")}async function bs_cache_save_toggle_perfmatters_settings_visibility(e,s){try{bs_cache_lock_screen();const a=await fetch(`${bs_cache_data.api_base}/settings-visibility`,{method:"PATCH",headers:{"Content-Type":"application/json; charset=UTF-8","X-WP-Nonce":bs_cache_data.api_nonce},body:JSON.stringify({user_id:parseInt(e),show_settings:s,toggle_settings_page:"perfmatters-settings"}),credentials:"same-origin",timeout:1e4});if(a.ok){const e=await a.json();bs_cache_unlock_screen(),e.code?bs_cache_display_ok_dialog("Error",`${e.message}`,null,null,"error"):e.success?bs_cache_display_ok_dialog("Success",`${e.message}`,null,null,"success",null,"Close",(()=>{bs_cache_refresh_page()})):bs_cache_display_ok_dialog("Error","Something went wrong! Please contact support for further investigation.",null,null,"error")}else{const e=await a.json();console.error(`${e.code}: ${e.message} (Status code: ${e.data.status})`),bs_cache_unlock_screen(),bs_cache_display_ok_dialog("Error",`Unable to toggle settings visibility. ${e.message} Please refresh the page and try again. If the issue remains, please contact our support team.`,null,null,"error")}}catch(e){alert(`Error: ${e.status} ${e.message}`),console.error(e),bs_cache_unlock_screen()}}async function bs_cache_force_purge_everything(){try{bs_cache_lock_screen();const e=await fetch(`${bs_cache_data.api_base}/clear-cache`,{method:"PATCH",headers:{"Content-Type":"application/json; charset=UTF-8","X-WP-Nonce":bs_cache_data.api_nonce},body:JSON.stringify({purge_type:"all"}),credentials:"same-origin",timeout:1e4});if(e.ok){const s=await e.json();bs_cache_unlock_screen(),s.code?bs_cache_display_ok_dialog("Error",`${s.message}`,null,null,"error"):s.success?bs_cache_display_ok_dialog("Success",`${s.message}`,null,null,"success"):bs_cache_display_ok_dialog("Error","Something went wrong! Please contact support for further investigation.",null,null,"error")}else{const s=await e.json();console.error(`${s.code}: ${s.message} (Status code: ${s.data.status})`),bs_cache_unlock_screen(),bs_cache_display_ok_dialog("Error",`Unable to clear whole cache for the website. ${s.message} Please refresh the page and try again. If the issue remains, please contact our support team.`,null,null,"error")}}catch(e){alert(`Error: ${e.status} ${e.message}`),console.error(e),bs_cache_unlock_screen()}}async function bs_cache_purge_user_given_urls(){Swal.fire({title:"Clear Cache for Specific URLs",titleText:"Clear Cache for Specific URLs",text:"Please list the URLs for cache clearance, placing each URL on a separate line below.",input:"textarea",inputAttributes:{name:"bs_cache_purge_user_given_urls_holder",required:"required",placeholder:"Enter each URL on a separate line. E.g.:\nhttps://example.com/wp-content/themes/example-theme/style.css?ver=1.2.3\nhttps://example.com/wp-content/uploads/2023/02/test.jpg"},showCancelButton:!0,confirmButtonText:"Clear Cache for These URLs",showLoaderOnConfirm:!0,allowEnterKey:!1,preConfirm:async e=>{try{let s=e.split("\n").filter((e=>""!==e));if(!(s.length>0))throw new Error("Please provide valid URLs. Make sure each new URL is added in a new line.");for(let e of s)if(!bs_cache_is_valid_url(e))throw new Error("Please provide valid URLs. Make sure each new URL is added in a new line.");const a=await fetch(`${bs_cache_data.api_base}/clear-cache`,{method:"PATCH",headers:{"Content-Type":"application/json; charset=UTF-8","X-WP-Nonce":bs_cache_data.api_nonce},body:JSON.stringify({purge_type:"urls",urls:s}),credentials:"same-origin",timeout:1e4});if(!a.ok){const e=await a.json();throw console.error(`${e.code}: ${e.message} (Status code: ${e.data.status})`),new Error(`Request failed: Unable to clear the cache for the entered URLs. ${e.message} Please refresh the page and try again. If the issue remains, please contact our support team.`)}return a.json()}catch(e){Swal.showValidationMessage(e)}},allowOutsideClick:()=>!Swal.isLoading()}).then((e=>{e.isConfirmed&&(e?.value?.code?bs_cache_display_ok_dialog("Error",`${e.value.message}`,null,null,"error"):e?.value?.success?bs_cache_display_ok_dialog("Success",`${e.value.message}`,null,null,"success"):bs_cache_display_ok_dialog("Error","Something went wrong! Please contact support for further investigation.",null,null,"error"))}))}async function bs_cache_purge_single_post_cache(e){try{bs_cache_lock_screen();const s=await fetch(`${bs_cache_data.api_base}/clear-cache`,{method:"PATCH",headers:{"Content-Type":"application/json; charset=UTF-8","X-WP-Nonce":bs_cache_data.api_nonce},body:JSON.stringify({purge_type:"post_ids",post_ids:[parseInt(e)],purge_related_urls:!0}),credentials:"same-origin",timeout:1e4});if(s.ok){const e=await s.json();bs_cache_unlock_screen(),e.code?bs_cache_display_ok_dialog("Error",`${e.message}`,null,null,"error"):e.success?bs_cache_display_ok_dialog("Success",`${e.message}`,null,null,"success"):bs_cache_display_ok_dialog("Error","Something went wrong! Please contact support for further investigation.",null,null,"error")}else{const a=await s.json();console.error(`${a.code}: ${a.message} (Status code: ${a.data.status})`),bs_cache_unlock_screen(),bs_cache_display_ok_dialog("Error",`Unable to clear the cache for the selected page (Post ID: ${e}). ${a.message} Please refresh the page and try again. If the issue remains, please contact our support team.`,null,null,"error")}}catch(e){alert(`Error: ${e.status} ${e.message}`),console.error(e),bs_cache_unlock_screen()}}async function bs_cache_purge_opcache(){try{bs_cache_lock_screen();const e=await fetch(`${bs_cache_data.api_base}/clear-opcache`,{method:"DELETE",headers:{"Content-Type":"application/json; charset=UTF-8","X-WP-Nonce":bs_cache_data.api_nonce},credentials:"same-origin",timeout:1e4});if(e.ok){const s=await e.json();bs_cache_unlock_screen(),s.code?bs_cache_display_ok_dialog("Error",`${s.message}`,null,null,"error"):s.success?bs_cache_display_ok_dialog("Success",`${s.message}`,null,null,"success"):bs_cache_display_ok_dialog("Error","Something went wrong! Please contact support for further investigation.",null,null,"error")}else{const s=await e.json();console.error(`${s.code}: ${s.message} (Status code: ${s.data.status})`),bs_cache_unlock_screen(),bs_cache_display_ok_dialog("Error",`Unable to clear OPcache. ${s.message} Please refresh the page and try again. If the issue remains, please contact our support team.`,null,null,"error")}}catch(e){alert(`Error: ${e.status} ${e.message}`),console.error(e),bs_cache_unlock_screen()}}async function bs_cache_import_config_file(e){try{bs_cache_lock_screen();const s=await fetch(`${bs_cache_data.api_base}/import-config`,{method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8","X-WP-Nonce":bs_cache_data.api_nonce},body:JSON.stringify({config:e}),credentials:"same-origin",timeout:1e4});if(s.ok){const e=await s.json();bs_cache_unlock_screen(),e.code?bs_cache_display_ok_dialog("Error",`${e.message}`,null,null,"error"):e.success?bs_cache_display_ok_dialog("Success",`${e.message}`,null,null,"success",null,"Ok",bs_cache_refresh_page):bs_cache_display_ok_dialog("Error","Something went wrong! Please contact support for further investigation.",null,null,"error")}else{const e=await s.json();console.error(`${e.code}: ${e.message} (Status code: ${e.data.status})`),bs_cache_unlock_screen(),bs_cache_display_ok_dialog("Error",`Unable to import config. ${e.message} Please refresh the page and try again. If the issue remains, please contact our support team.`,null,null,"error")}}catch(e){alert(`Error: ${e.status} ${e.message}`),console.error(e),bs_cache_unlock_screen()}}async function bs_cache_test_page_cache(){try{bs_cache_lock_screen();const e=await fetch(`${bs_cache_data.api_base}/test-cache`,{method:"GET",headers:{"Content-Type":"application/json; charset=UTF-8","X-WP-Nonce":bs_cache_data.api_nonce},credentials:"same-origin",timeout:1e4});if(e.ok){const s=await e.json();bs_cache_unlock_screen(),s.code?bs_cache_display_ok_dialog("Error",`${s.message}`,null,null,"error"):s.success?bs_cache_display_ok_dialog("Success",`${s.message}`,null,null,"success"):bs_cache_display_ok_dialog("Error","Something went wrong! Please contact support for further investigation.",null,null,"error")}else{const s=await e.json();console.error(`${s.code}: ${s.message} (Status code: ${s.data.status})`),bs_cache_unlock_screen(),bs_cache_display_ok_dialog("Error",`Unable to perform test cache operation. ${s.message} Please refresh the page and try again. If the issue remains, please contact our support team.`,null,null,"error")}}catch(e){alert(`Error: ${e.status} ${e.message}`),console.error(e),bs_cache_unlock_screen()}}async function bs_cache_enable_page_cache(){try{bs_cache_lock_screen();const e=await fetch(`${bs_cache_data.api_base}/enable-cache`,{method:"PATCH",headers:{"Content-Type":"application/json; charset=UTF-8","X-WP-Nonce":bs_cache_data.api_nonce},credentials:"same-origin",timeout:1e4});if(e.ok){const s=await e.json();bs_cache_unlock_screen(),s.code?bs_cache_display_ok_dialog("Error",`${s.message}`,null,null,"error"):s.success?bs_cache_display_ok_dialog("Success",`${s.message}`,null,null,"success",null,"Ok",bs_cache_refresh_page):bs_cache_display_ok_dialog("Error","Something went wrong! Please contact support for further investigation.",null,null,"error")}else{const s=await e.json();console.error(`${s.code}: ${s.message} (Status code: ${s.data.status})`),bs_cache_unlock_screen(),bs_cache_display_ok_dialog("Error",`Unable to enable caching for your website. ${s.message} Please refresh the page and try again. If the issue remains, please contact our support team.`,null,null,"error")}}catch(e){alert(`Error: ${e.status} ${e.message}`),console.error(e),bs_cache_unlock_screen()}}async function bs_cache_disable_page_cache(){try{bs_cache_lock_screen();const e=await fetch(`${bs_cache_data.api_base}/disable-cache`,{method:"PATCH",headers:{"Content-Type":"application/json; charset=UTF-8","X-WP-Nonce":bs_cache_data.api_nonce},credentials:"same-origin",timeout:1e4});if(e.ok){const s=await e.json();bs_cache_unlock_screen(),s.code?bs_cache_display_ok_dialog("Error",`${s.message}`,null,null,"error"):s.success?bs_cache_display_ok_dialog("Success",`${s.message}`,null,null,"success",null,"Ok",bs_cache_refresh_page):bs_cache_display_ok_dialog("Error","Something went wrong! Please contact support for further investigation.",null,null,"error")}else{const s=await e.json();console.error(`${s.code}: ${s.message} (Status code: ${s.data.status})`),bs_cache_unlock_screen(),bs_cache_display_ok_dialog("Error",`Unable to disable caching for your website. ${s.message} Please refresh the page and try again. If the issue remains, please contact our support team.`,null,null,"error")}}catch(e){alert(`Error: ${e.status} ${e.message}`),console.error(e),bs_cache_unlock_screen()}}async function bs_cache_clear_logs(){try{bs_cache_lock_screen();const e=await fetch(`${bs_cache_data.api_base}/clear-logs`,{method:"DELETE",headers:{"Content-Type":"application/json; charset=UTF-8","X-WP-Nonce":bs_cache_data.api_nonce},credentials:"same-origin",timeout:1e4});if(e.ok){const s=await e.json();bs_cache_unlock_screen(),s.code?bs_cache_display_ok_dialog("Error",`${s.message}`,null,null,"error"):s.success?bs_cache_display_ok_dialog("Success",`${s.message}`,null,null,"success"):bs_cache_display_ok_dialog("Error","Something went wrong! Please contact support for further investigation.",null,null,"error")}else{const s=await e.json();console.error(`${s.code}: ${s.message} (Status code: ${s.data.status})`),bs_cache_unlock_screen(),bs_cache_display_ok_dialog("Error",`Unable to clear the log file. ${s.message} Please refresh the page and try again. If the issue remains, please contact our support team.`,null,null,"error")}}catch(e){alert(`Error: ${e.status} ${e.message}`),console.error(e),bs_cache_unlock_screen()}}function add_cache_status_class_frontend(){if(document.body.classList.contains("bs-cache-enabled")||document.body.classList.contains("bs-cache-disabled")||document.body.classList.contains("bs-cache-misconfigured"))return;const e=bs_cache_data.cache_status,s=parseInt(bs_cache_data.cache_enabled);"Misconfigured"===e?document.body.classList.add("bs-cache-misconfigured"):s>0?document.body.classList.add("bs-cache-enabled"):document.body.classList.add("bs-cache-disabled")}if(document.querySelector("#bs_cache_tab_links .nav-tab")){const e=document.querySelectorAll("#bs_cache_tab_links .nav-tab");e.forEach((s=>{s.addEventListener("click",(s=>{s.preventDefault();const a=s.target.dataset.tab;if(void 0===typeof a)return!0;e.forEach((e=>{e.classList.contains("nav-tab-active")&&e.classList.remove("nav-tab-active")})),s.target.classList.add("nav-tab-active"),document.querySelectorAll(".bs_cache_tab").forEach((e=>{e.classList.contains("active")&&e.classList.remove("active")})),document.getElementById(a).classList.add("active"),document.querySelector("input[name=bs_cache_tab]").value=a}))}))}document.addEventListener("DOMContentLoaded",(e=>{if(add_cache_status_class_frontend(),document.getElementById("bs_cache_main_content")){if(document.querySelectorAll(".conditional_item").length>0&&document.querySelectorAll(".conditional_item").forEach((e=>{e.checked&&bs_cache_handle_conditional_settings(e),e.addEventListener("click",(e=>{bs_cache_handle_conditional_settings(e.target)}))})),document.querySelector("#bs_cache_tab_links .nav-tab-active")){const e=document.querySelector("#bs_cache_tab_links .nav-tab-active").dataset.tab;void 0!==typeof e&&(document.querySelector("input[name=bs_cache_tab]").value=e)}bs_cache_handle_automatic_purge_option_selection()}document.getElementById("toggle-bs-cache-settings")&&document.getElementById("toggle-bs-cache-settings").addEventListener("click",(e=>{e.preventDefault(),bs_cache_toggle_settings_visibility()})),document.getElementById("toggle-perfmatters-settings")&&document.getElementById("toggle-perfmatters-settings").addEventListener("click",(e=>{e.preventDefault(),bs_cache_toggle_perfmatters_settings_visibility()})),document.getElementById("bs_cache_clear_logs")&&document.getElementById("bs_cache_clear_logs").addEventListener("click",(e=>{e.preventDefault(),bs_cache_clear_logs()})),document.querySelector("#bs_cache_import_config_start")&&document.querySelector("#bs_cache_import_config_start").addEventListener("click",(e=>{e.preventDefault();bs_cache_import_config_file(document.querySelector("#bs_cache_import_config_content").value)})),document.querySelector("#wp-admin-bar-bs-cache-toolbar-force-purge-everything a")&&document.querySelector("#wp-admin-bar-bs-cache-toolbar-force-purge-everything a").addEventListener("click",(e=>{e.preventDefault(),bs_cache_force_purge_everything()})),document.querySelector("#wp-admin-bar-bs-cache-toolbar-purge-user-given-urls a")&&document.querySelector("#wp-admin-bar-bs-cache-toolbar-purge-user-given-urls a").addEventListener("click",(e=>{e.preventDefault(),bs_cache_purge_user_given_urls()})),document.querySelector("#wp-admin-bar-bs-cache-toolbar-purge-single a")&&document.querySelector("#wp-admin-bar-bs-cache-toolbar-purge-single a").addEventListener("click",(e=>{e.preventDefault();bs_cache_purge_single_post_cache(e.target.hash.replace("#",""))})),document.querySelector(".bs_cache_action_row_single_post_cache_purge")&&document.querySelectorAll(".bs_cache_action_row_single_post_cache_purge").forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault();bs_cache_purge_single_post_cache(e.target.dataset.post_id)}))})),document.getElementById("bs_cache_purge_cache_everything")&&document.getElementById("bs_cache_purge_cache_everything").addEventListener("click",(e=>{e.preventDefault(),bs_cache_force_purge_everything()})),document.getElementById("bs_cache_purge_user_given_urls")&&document.getElementById("bs_cache_purge_user_given_urls").addEventListener("click",(e=>{e.preventDefault(),bs_cache_purge_user_given_urls()})),document.getElementById("bs_cache_form_test_cache")&&document.getElementById("bs_cache_form_test_cache").addEventListener("submit",(e=>{e.preventDefault(),bs_cache_test_page_cache()})),document.getElementById("bs_cache_form_enable_cache")&&document.getElementById("bs_cache_form_enable_cache").addEventListener("submit",(e=>{e.preventDefault(),bs_cache_enable_page_cache()})),document.getElementById("bs_cache_form_disable_cache")&&document.getElementById("bs_cache_form_disable_cache").addEventListener("submit",(e=>{e.preventDefault(),bs_cache_disable_page_cache()})),document.getElementById("bs_cache_form_purge_opcache")&&document.getElementById("bs_cache_form_purge_opcache").addEventListener("submit",(e=>{e.preventDefault(),bs_cache_purge_opcache()}))}));